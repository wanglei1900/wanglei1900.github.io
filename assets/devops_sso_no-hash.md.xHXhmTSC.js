import{_ as d,C as k,c as o,o as n,a7 as e,j as a,b as t,w as i,a as p,G as h,a8 as r}from"./chunks/framework.Dtft01Yp.js";const F=JSON.parse('{"title":"å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰è·³è½¬ä¸­é¿å…ä½¿ç”¨Hashæ¨¡å¼çš„åŸå› ","description":"","frontmatter":{},"headers":[],"relativePath":"devops/sso/no-hash.md","filePath":"devops/sso/no-hash.md","lastUpdated":1751275676000}'),c={name:"devops/sso/no-hash.md"};function E(u,s,b,g,A,m){const l=k("Mermaid");return n(),o("div",null,[s[4]||(s[4]=e(`<h1 id="å•ç‚¹ç™»å½•-sso-è·³è½¬ä¸­é¿å…ä½¿ç”¨hashæ¨¡å¼çš„åŸå› " tabindex="-1">å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰è·³è½¬ä¸­é¿å…ä½¿ç”¨Hashæ¨¡å¼çš„åŸå›  <a class="header-anchor" href="#å•ç‚¹ç™»å½•-sso-è·³è½¬ä¸­é¿å…ä½¿ç”¨hashæ¨¡å¼çš„åŸå› " aria-label="Permalink to &quot;å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰è·³è½¬ä¸­é¿å…ä½¿ç”¨Hashæ¨¡å¼çš„åŸå› &quot;">â€‹</a></h1><h2 id="ğŸ”’-ä¸€ã€æ ¸å¿ƒé—®é¢˜-urlç‰‡æ®µ-hash-çš„ä¼ è¾“ç‰¹æ€§" tabindex="-1">ğŸ”’ ä¸€ã€æ ¸å¿ƒé—®é¢˜ï¼šURLç‰‡æ®µï¼ˆHashï¼‰çš„ä¼ è¾“ç‰¹æ€§ <a class="header-anchor" href="#ğŸ”’-ä¸€ã€æ ¸å¿ƒé—®é¢˜-urlç‰‡æ®µ-hash-çš„ä¼ è¾“ç‰¹æ€§" aria-label="Permalink to &quot;ğŸ”’ ä¸€ã€æ ¸å¿ƒé—®é¢˜ï¼šURLç‰‡æ®µï¼ˆHashï¼‰çš„ä¼ è¾“ç‰¹æ€§&quot;">â€‹</a></h2><h3 id="_1-æµè§ˆå™¨ä¸å‘é€hashç‰‡æ®µåˆ°æœåŠ¡å™¨" tabindex="-1">1 æµè§ˆå™¨ä¸å‘é€Hashç‰‡æ®µåˆ°æœåŠ¡å™¨ <a class="header-anchor" href="#_1-æµè§ˆå™¨ä¸å‘é€hashç‰‡æ®µåˆ°æœåŠ¡å™¨" aria-label="Permalink to &quot;1 æµè§ˆå™¨ä¸å‘é€Hashç‰‡æ®µåˆ°æœåŠ¡å™¨&quot;">â€‹</a></h3><ul><li>Hashéƒ¨åˆ†ï¼ˆ#åé¢çš„å†…å®¹ï¼‰æ°¸è¿œä¸ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨</li><li>ç¤ºä¾‹ï¼š<a href="https://app.com/#/dashboard?token=abc123" target="_blank" rel="noreferrer">https://app.com/#/dashboard?token=abc123</a><ul><li>æµè§ˆå™¨å®é™…è¯·æ±‚ï¼š<a href="https://app.com/" target="_blank" rel="noreferrer">https://app.com/</a></li><li>æœåŠ¡å™¨å®Œå…¨çœ‹ä¸åˆ°#/dashboard?token=abc123</li></ul></li></ul><h3 id="_1-ssoæµç¨‹ä¸­çš„å…³é”®æ•°æ®ä¸¢å¤±" tabindex="-1">1 SSOæµç¨‹ä¸­çš„å…³é”®æ•°æ®ä¸¢å¤± <a class="header-anchor" href="#_1-ssoæµç¨‹ä¸­çš„å…³é”®æ•°æ®ä¸¢å¤±" aria-label="Permalink to &quot;1 SSOæµç¨‹ä¸­çš„å…³é”®æ•°æ®ä¸¢å¤±&quot;">â€‹</a></h3><ul><li>è®¤è¯æœåŠ¡å™¨è¿”å›çš„å…³é”®å‚æ•°ä¼šè¢«ä¸¢å¼ƒï¼š</li></ul><div class="language-http vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è®¤è¯æœåŠ¡å™¨é‡å®šå‘</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">HTTP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 302</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Found</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Location</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://app.com/#/callback?code=AUTH_CODE&amp;state=123</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æµè§ˆå™¨å®é™…è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> / </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">HTTP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app.com</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å®Œå…¨ä¸¢å¤± #/callback?code=AUTH_CODE&amp;state=123</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="âš ï¸-äºŒã€å…·ä½“é—®é¢˜åˆ†æ" tabindex="-1">âš ï¸ äºŒã€å…·ä½“é—®é¢˜åˆ†æ <a class="header-anchor" href="#âš ï¸-äºŒã€å…·ä½“é—®é¢˜åˆ†æ" aria-label="Permalink to &quot;âš ï¸ äºŒã€å…·ä½“é—®é¢˜åˆ†æ&quot;">â€‹</a></h2><h3 id="_1-æˆæƒç ä¸¢å¤±-oauth2æˆæƒç æ¨¡å¼" tabindex="-1">1 æˆæƒç ä¸¢å¤±ï¼ˆOAuth2æˆæƒç æ¨¡å¼ï¼‰ <a class="header-anchor" href="#_1-æˆæƒç ä¸¢å¤±-oauth2æˆæƒç æ¨¡å¼" aria-label="Permalink to &quot;1 æˆæƒç ä¸¢å¤±ï¼ˆOAuth2æˆæƒç æ¨¡å¼ï¼‰&quot;">â€‹</a></h3>`,9)),a("ul",null,[a("li",null,[s[1]||(s[1]=a("p",null,"æ­£è§„æµç¨‹ï¼š",-1)),(n(),t(r,null,{default:i(()=>[h(l,{id:"mermaid-55",class:"mermaid",graph:"sequenceDiagram%0AClient-%3E%3EAuth%20Server%3A%20%E8%AF%B7%E6%B1%82%E6%8E%88%E6%9D%83%0AAuth%20Server-%3E%3EUser%3A%20%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2%0AUser-%3E%3EAuth%20Server%3A%20%E6%8F%90%E4%BA%A4%E5%87%AD%E8%AF%81%0AAuth%20Server-%3E%3EClient%3A%20302%E9%87%8D%E5%AE%9A%E5%90%91%E6%90%BA%E5%B8%A6code%0AClient-%3E%3EAuth%20Server%3A%20%E7%94%A8code%E4%BA%A4%E6%8D%A2token%0A"})]),fallback:i(()=>s[0]||(s[0]=[p(" Loading... ")])),_:1}))]),s[2]||(s[2]=a("li",null,[a("p",null,"Hashæ¨¡å¼é—®é¢˜ï¼š"),a("ul",null,[a("li",null,"æˆæƒç codeåœ¨hashä¸­è¢«ä¸¢å¼ƒ"),a("li",null,"å®¢æˆ·ç«¯æ— æ³•å®Œæˆtokenäº¤æ¢")])],-1))]),s[5]||(s[5]=e(`<h3 id="_2-tokenæš´éœ²é£é™©-éšå¼æ¨¡å¼" tabindex="-1">2 Tokenæš´éœ²é£é™©ï¼ˆéšå¼æ¨¡å¼ï¼‰ <a class="header-anchor" href="#_2-tokenæš´éœ²é£é™©-éšå¼æ¨¡å¼" aria-label="Permalink to &quot;2 Tokenæš´éœ²é£é™©ï¼ˆéšå¼æ¨¡å¼ï¼‰&quot;">â€‹</a></h3><ul><li>å½“ä½¿ç”¨Implicit Flowæ—¶ï¼š<div class="language-text vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>é‡å®šå‘URL: https://app.com/#access_token=eyxxx&amp;expires_in=3600</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li>é£é™©ï¼š <ul><li>Tokenæš´éœ²åœ¨å®¢æˆ·ç«¯URLä¸­</li><li>å¯èƒ½è¢«æµè§ˆå™¨å†å²è®°å½•ã€Refererå¤´æ³„éœ²</li><li>å¯èƒ½è¢«æ¶æ„æµè§ˆå™¨æ‰©å±•æ•è·</li></ul></li></ul><h3 id="_3-çŠ¶æ€å‚æ•°ä¸¢å¤±" tabindex="-1">3 çŠ¶æ€å‚æ•°ä¸¢å¤± <a class="header-anchor" href="#_3-çŠ¶æ€å‚æ•°ä¸¢å¤±" aria-label="Permalink to &quot;3 çŠ¶æ€å‚æ•°ä¸¢å¤±&quot;">â€‹</a></h3><ul><li>çŠ¶æ€å‚æ•°stateç”¨äºé˜²æ­¢CSRFæ”»å‡»ï¼š<div class="language-text vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>åˆå§‹è¯·æ±‚: state=8a7s6d</span></span>
<span class="line"><span>å›è°ƒæ—¶åº”éªŒè¯: state=8a7s6d</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li>Hashæ¨¡å¼ä¸‹ï¼šstateå‚æ•°æ— æ³•è¢«æœåŠ¡å™¨éªŒè¯</li></ul><h3 id="_4-pkceæ‰©å±•å¤±æ•ˆ" tabindex="-1">4. PKCEæ‰©å±•å¤±æ•ˆ <a class="header-anchor" href="#_4-pkceæ‰©å±•å¤±æ•ˆ" aria-label="Permalink to &quot;4. PKCEæ‰©å±•å¤±æ•ˆ&quot;">â€‹</a></h3><ul><li>PKCEï¼ˆProof Key for Code Exchangeï¼‰æµç¨‹ï¼š <ol><li>å®¢æˆ·ç«¯ç”Ÿæˆcode_verifier</li><li>å‘é€code_challengeï¼ˆverifierçš„å˜æ¢å€¼ï¼‰</li><li>å›è°ƒæ—¶æäº¤åŸå§‹code_verifier</li></ol></li><li>Hashæ¨¡å¼ä¸‹ï¼š <ul><li>æ— æ³•å®‰å…¨ä¼ é€’code_verifier</li><li>PKCEä¿æŠ¤æœºåˆ¶å¤±æ•ˆ</li></ul></li></ul><h2 id="âœ…-ä¸‰ã€æ¨èè§£å†³æ–¹æ¡ˆ" tabindex="-1">âœ… ä¸‰ã€æ¨èè§£å†³æ–¹æ¡ˆ <a class="header-anchor" href="#âœ…-ä¸‰ã€æ¨èè§£å†³æ–¹æ¡ˆ" aria-label="Permalink to &quot;âœ… ä¸‰ã€æ¨èè§£å†³æ–¹æ¡ˆ&quot;">â€‹</a></h2><h3 id="_1-ä½¿ç”¨historyæ¨¡å¼-å‰ç«¯è·¯ç”±" tabindex="-1">1 ä½¿ç”¨Historyæ¨¡å¼ï¼ˆå‰ç«¯è·¯ç”±ï¼‰ <a class="header-anchor" href="#_1-ä½¿ç”¨historyæ¨¡å¼-å‰ç«¯è·¯ç”±" aria-label="Permalink to &quot;1 ä½¿ç”¨Historyæ¨¡å¼ï¼ˆå‰ç«¯è·¯ç”±ï¼‰&quot;">â€‹</a></h3><ul><li>é…ç½®ç¤ºä¾‹ï¼ˆVue Routerï¼‰ï¼š</li></ul><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> router</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> VueRouter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;history&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä½¿ç”¨HTML5 Historyæ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  routes: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-æœåŠ¡å™¨ç«¯é…åˆæ”¯æŒ" tabindex="-1">2 æœåŠ¡å™¨ç«¯é…åˆæ”¯æŒ <a class="header-anchor" href="#_2-æœåŠ¡å™¨ç«¯é…åˆæ”¯æŒ" aria-label="Permalink to &quot;2 æœåŠ¡å™¨ç«¯é…åˆæ”¯æŒ&quot;">â€‹</a></h3><ul><li>Nginxé…ç½®ç¤ºä¾‹ï¼š</li></ul><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$uri $uri/ /index.html;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_3-å®‰å…¨çš„å›è°ƒå¤„ç†æµç¨‹" tabindex="-1">3 å®‰å…¨çš„å›è°ƒå¤„ç†æµç¨‹ <a class="header-anchor" href="#_3-å®‰å…¨çš„å›è°ƒå¤„ç†æµç¨‹" aria-label="Permalink to &quot;3 å®‰å…¨çš„å›è°ƒå¤„ç†æµç¨‹&quot;">â€‹</a></h3>`,14)),(n(),t(r,null,{default:i(()=>[h(l,{id:"mermaid-196",class:"mermaid",graph:"sequenceDiagram%0A%20%20participant%20User%0A%20%20participant%20ClientApp%0A%20%20participant%20AuthServer%0A%20%20participant%20BackendAPI%0A%20%20%0A%20%20User-%3E%3EClientApp%3A%20%E8%AE%BF%E9%97%AE%E5%BA%94%E7%94%A8%0A%20%20ClientApp-%3E%3EAuthServer%3A%20%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E7%99%BB%E5%BD%95%0A%20%20User-%3E%3EAuthServer%3A%20%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81%0A%20%20AuthServer-%3E%3EClientApp%3A%20302%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%2Fcallback%3Fcode%3DABC123%0A%20%20ClientApp-%3E%3EBackendAPI%3A%20POST%20%2Fexchange-token%20(%E6%90%BA%E5%B8%A6code)%0A%20%20BackendAPI-%3E%3EAuthServer%3A%20%E9%AA%8C%E8%AF%81code%2BPKCE%0A%20%20AuthServer-%3E%3EBackendAPI%3A%20%E8%BF%94%E5%9B%9Eaccess_token%0A%20%20BackendAPI-%3E%3EClientApp%3A%20%E8%AE%BE%E7%BD%AEHttpOnly%20Cookie%0A%20%20ClientApp-%3E%3EUser%3A%20%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E4%B8%BB%E9%A1%B5%E9%9D%A2%0A"})]),fallback:i(()=>s[3]||(s[3]=[p(" Loading... ")])),_:1})),s[6]||(s[6]=e(`<h3 id="_4-æœ€ä½³å®è·µå‚æ•°ä¼ é€’" tabindex="-1">4 æœ€ä½³å®è·µå‚æ•°ä¼ é€’ <a class="header-anchor" href="#_4-æœ€ä½³å®è·µå‚æ•°ä¼ é€’" aria-label="Permalink to &quot;4 æœ€ä½³å®è·µå‚æ•°ä¼ é€’&quot;">â€‹</a></h3><div class="language-http vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ­£ç¡®æ–¹å¼ï¼ˆä½¿ç”¨queryå‚æ•°ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">HTTP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 302</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Found</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Location</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://app.com/callback?code=AUTH_CODE&amp;state=123</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å®¢æˆ·ç«¯å¤„ç†æµç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">1. åç«¯æ¥æ”¶ /callback è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">2. åç«¯ç”¨codeäº¤æ¢token</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">3. åç«¯è®¾ç½®å®‰å…¨Cookie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">4. é‡å®šå‘åˆ°å‰ç«¯ä¸»è·¯ç”±</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="ğŸ›¡ï¸-ä¸‰ã€å®‰å…¨å¢å¼ºæªæ–½" tabindex="-1">ğŸ›¡ï¸ ä¸‰ã€å®‰å…¨å¢å¼ºæªæ–½ <a class="header-anchor" href="#ğŸ›¡ï¸-ä¸‰ã€å®‰å…¨å¢å¼ºæªæ–½" aria-label="Permalink to &quot;ğŸ›¡ï¸ ä¸‰ã€å®‰å…¨å¢å¼ºæªæ–½&quot;">â€‹</a></h2><ol><li>å§‹ç»ˆä½¿ç”¨PKCEæ‰©å±• <ul><li>å³ä½¿æ˜¯éå…¬å…±å®¢æˆ·ç«¯ä¹Ÿæ¨èä½¿ç”¨</li><li>æœ‰æ•ˆé˜²æ­¢æˆæƒç æˆªè·æ”»å‡»</li></ul></li><li>Tokenå­˜å‚¨å®‰å…¨</li></ol><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¸å®‰å…¨   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;token&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, response.token)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¨èæ–¹æ¡ˆ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åç«¯è®¾ç½®HttpOnly Cookie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: access_token</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">xxx; HttpOnly; Secure; SameSite</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Lax</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="3"><li>ä¸¥æ ¼çš„Redirect URIéªŒè¯</li></ol><ul><li>åœ¨æˆæƒæœåŠ¡å™¨æ³¨å†Œå®Œæ•´URLï¼š</li></ul><div class="language-text vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>å…è®¸: https://app.com/callback</span></span>
<span class="line"><span>æ‹’ç»: https://app.com</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="4"><li>Stateå‚æ•°å¿…ç”¨</li></ol><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç”Ÿæˆéšæœºçš„stateå‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> state</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> crypto.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">randomBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hex&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å­˜å‚¨åˆ°sessionStorage</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sessionStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;oauth_state&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, state)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é‡å®šå‘æ—¶åŒ…å«state</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redirectTo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`/auth?state=\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="ğŸ’¡-äº”ã€ç»“è®º-ä¸ºä»€ä¹ˆå¿…é¡»é¿å…hashæ¨¡å¼" tabindex="-1">ğŸ’¡ äº”ã€ç»“è®ºï¼šä¸ºä»€ä¹ˆå¿…é¡»é¿å…Hashæ¨¡å¼ <a class="header-anchor" href="#ğŸ’¡-äº”ã€ç»“è®º-ä¸ºä»€ä¹ˆå¿…é¡»é¿å…hashæ¨¡å¼" aria-label="Permalink to &quot;ğŸ’¡ äº”ã€ç»“è®ºï¼šä¸ºä»€ä¹ˆå¿…é¡»é¿å…Hashæ¨¡å¼&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>é—®é¢˜ç±»å‹</th><th>Hashæ¨¡å¼é£é™©</th><th>Historyæ¨¡å¼è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>å‚æ•°ä¼ é€’</td><td>å…³é”®å‚æ•°ä¸¢å¤±</td><td>å®Œæ•´ä¼ é€’queryå‚æ•°</td></tr><tr><td>å®‰å…¨æ€§</td><td>Tokenæš´éœ²é£é™©é«˜</td><td>Tokenå¯é€šè¿‡åç«¯å®‰å…¨äº¤æ¢</td></tr><tr><td>PKCEæ”¯æŒ</td><td>æ— æ³•å®ç°å®Œæ•´PKCEæµç¨‹</td><td>æ”¯æŒå®Œæ•´PKCEä¿æŠ¤</td></tr><tr><td>CSRFé˜²æŠ¤</td><td>Stateå‚æ•°æ— æ³•éªŒè¯</td><td>å®Œæ•´StateéªŒè¯æµç¨‹</td></tr><tr><td>æœåŠ¡å™¨æ”¯æŒ</td><td>æ— éœ€æœåŠ¡å™¨é…ç½®</td><td>éœ€è¦ç®€å•è·¯ç”±é…ç½®</td></tr><tr><td>SEOå‹å¥½åº¦</td><td>ä¸å‹å¥½</td><td>å‹å¥½</td></tr></tbody></table><p>æœ€ç»ˆå»ºè®®ï¼šåœ¨SSOé›†æˆä¸­å§‹ç»ˆä½¿ç”¨Historyæ¨¡å¼+åç«¯å›è°ƒå¤„ç†ï¼Œé¿å…å°†æ•æ„Ÿå‚æ•°æ”¾åœ¨URL hashä¸­ã€‚è™½ç„¶éœ€è¦é¢å¤–çš„æœåŠ¡å™¨é…ç½®ï¼Œä½†è¿™æ˜¯å®ç°å®‰å…¨ã€å¯é å•ç‚¹ç™»å½•çš„å¿…è¦ä»£ä»·ã€‚</p>`,13))])}const C=d(c,[["render",E]]);export{F as __pageData,C as default};
