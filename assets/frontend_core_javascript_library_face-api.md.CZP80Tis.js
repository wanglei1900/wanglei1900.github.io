import{_ as h,C as e,c as p,o as i,a7 as a,b as t,w as n,a as k,G as r,a8 as E}from"./chunks/framework.Dtft01Yp.js";const m=JSON.parse('{"title":"face-api.js 全面学习指南","description":"","frontmatter":{},"headers":[],"relativePath":"frontend/core/javascript/library/face-api.md","filePath":"frontend/core/javascript/library/face-api.md","lastUpdated":1752053266000}'),d={name:"frontend/core/javascript/library/face-api.md"};function c(g,s,y,F,o,b){const l=e("Mermaid");return i(),p("div",null,[s[1]||(s[1]=a('<h1 id="face-api-js-全面学习指南" tabindex="-1">face-api.js 全面学习指南 <a class="header-anchor" href="#face-api-js-全面学习指南" aria-label="Permalink to &quot;face-api.js 全面学习指南&quot;">​</a></h1><nav class="table-of-contents"><ul><li><a href="#一、核心概念与原理">一、核心概念与原理</a></li><li><a href="#二、环境搭建与模型加载">二、环境搭建与模型加载</a></li><li><a href="#三、基础功能实现">三、基础功能实现</a></li><li><a href="#四、高级应用场景">四、高级应用场景</a></li><li><a href="#五、性能优化与调试">五、性能优化与调试</a></li><li><a href="#六、实际案例">六、实际案例</a></li><li><a href="#七、迁移与替代方案">七、迁移与替代方案</a></li><li><a href="#八、常见问题解决">八、常见问题解决</a></li><li><a href="#🔗-九、参考资料">🔗 九、参考资料</a></li></ul></nav><h2 id="一、核心概念与原理" tabindex="-1">一、核心概念与原理 <a class="header-anchor" href="#一、核心概念与原理" aria-label="Permalink to &quot;一、核心概念与原理&quot;">​</a></h2><h4 id="_1-face-api-js-是什么" tabindex="-1">1. face-api.js 是什么？ <a class="header-anchor" href="#_1-face-api-js-是什么" aria-label="Permalink to &quot;1. face-api.js 是什么？&quot;">​</a></h4><p>基于 TensorFlow.js 的 JavaScript 人脸识别库，支持：</p><ul><li>人脸检测：定位图像/视频中的人脸边界框</li><li>特征点标记：识别 68 个面部关键点（眼、鼻、嘴等）</li><li>人脸识别：计算人脸特征向量（128 维描述符）并比对相似度</li><li>属性分析：表情、年龄、性别预测</li></ul><h4 id="_2-工作原理" tabindex="-1">2. 工作原理 <a class="header-anchor" href="#_2-工作原理" aria-label="Permalink to &quot;2. 工作原理&quot;">​</a></h4>',7)),(i(),t(E,null,{default:n(()=>[r(l,{id:"mermaid-40",class:"mermaid",graph:"graph%20LR%0AA%5B%E8%BE%93%E5%85%A5%E5%9B%BE%E5%83%8F%2F%E8%A7%86%E9%A2%91%5D%20--%3E%20B(SSD%20Mobilenet%2FTinyFace%20%E6%A3%80%E6%B5%8B%E4%BA%BA%E8%84%B8)%0AB%20--%3E%20C(68%E7%82%B9%E7%89%B9%E5%BE%81%E5%AE%9A%E4%BD%8D)%0AC%20--%3E%20D%7B%E9%9C%80%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD%EF%BC%9F%7D%0AD%20--%3E%7C%E6%98%AF%7C%20E%5B%E8%A1%A8%E6%83%85%2F%E5%B9%B4%E9%BE%84%2F%E6%80%A7%E5%88%AB%E6%A8%A1%E5%9E%8B%5D%0AD%20--%3E%7C%E5%90%A6%7C%20F%5B%E8%BE%93%E5%87%BA%E8%BE%B9%E7%95%8C%E6%A1%86%5D%0AE%20--%3E%20G%5B%E7%94%9F%E6%88%90%E7%89%B9%E5%BE%81%E6%8F%8F%E8%BF%B0%E7%AC%A6%5D%0AG%20--%3E%20H%5B%E4%BA%BA%E8%84%B8%E5%8C%B9%E9%85%8D%5D%0A"})]),fallback:n(()=>s[0]||(s[0]=[k(" Loading... ")])),_:1})),s[2]||(s[2]=a(`<p>关键点：</p><ul><li>人脸对齐：通过 68 个特征点矫正人脸角度，提升识别精度</li><li>相似度计算：欧氏距离（Euclidean Distance）比对特征向量，阈值 &lt;0.6 视为同一人</li></ul><br><h2 id="二、环境搭建与模型加载" tabindex="-1">二、环境搭建与模型加载 <a class="header-anchor" href="#二、环境搭建与模型加载" aria-label="Permalink to &quot;二、环境搭建与模型加载&quot;">​</a></h2><h4 id="_1-安装方式" tabindex="-1">1. 安装方式 <a class="header-anchor" href="#_1-安装方式" aria-label="Permalink to &quot;1. 安装方式&quot;">​</a></h4><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># NPM 安装</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> face-api.js</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># CDN 引入</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">script src</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://cdn.jsdelivr.net/npm/face-api.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/script</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_2-模型加载" tabindex="-1">2. 模型加载 <a class="header-anchor" href="#_2-模型加载" aria-label="Permalink to &quot;2. 模型加载&quot;">​</a></h4><p>模型需从官方仓库下载，存放于项目目录（如 /public/models）：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 加载基础模型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  faceapi.nets.tinyFaceDetector.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadFromUri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/models&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  faceapi.nets.faceLandmark68Net.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadFromUri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/models&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  faceapi.nets.faceRecognitionNet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadFromUri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/models&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可选扩展模型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.nets.faceExpressionNet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadFromUri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/models&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 表情识别</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.nets.ageGenderNet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadFromUri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/models&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 年龄性别</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>注意：</p><ul><li>模型路径需可访问，否则报错 ENOENT</li><li>Webpack 用户需忽略 fs 模块警告（配置 resolve.fallback: { fs: false }）</li></ul><h2 id="三、基础功能实现" tabindex="-1">三、基础功能实现 <a class="header-anchor" href="#三、基础功能实现" aria-label="Permalink to &quot;三、基础功能实现&quot;">​</a></h2><h4 id="_1-实时摄像头人脸检测" tabindex="-1">1. 实时摄像头人脸检测 <a class="header-anchor" href="#_1-实时摄像头人脸检测" aria-label="Permalink to &quot;1. 实时摄像头人脸检测&quot;">​</a></h4><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 开启摄像头</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">navigator.mediaDevices.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getUserMedia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ video: {} })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">stream</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    video.srcObject </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> stream;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">video.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;play&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> canvas</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createCanvasFromMedia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(video);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(canvas);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> displaySize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { width: video.width, height: video.height };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">matchDimensions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(canvas, displaySize);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> detections</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">detectAllFaces</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(video, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TinyFaceDetectorOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">withFaceLandmarks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">withFaceExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> resizedDetections</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resizeResults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(detections, displaySize);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    canvas.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clearRect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, canvas.width, canvas.height);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    faceapi.draw.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">drawDetections</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(canvas, resizedDetections);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    faceapi.draw.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">drawFaceLandmarks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(canvas, resizedDetections);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    faceapi.draw.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">drawFaceExpressions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(canvas, resizedDetections);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 检测频率 100ms</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="_2-静态图像分析" tabindex="-1">2. 静态图像分析 <a class="header-anchor" href="#_2-静态图像分析" aria-label="Permalink to &quot;2. 静态图像分析&quot;">​</a></h4><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> img</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;myImage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> detections</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">detectSingleFace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(img, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SsdMobilenetv1Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">withFaceLandmarks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">withAgeAndGender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 绘制结果</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> canvas</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createCanvasFromMedia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(img);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">age</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">genderProbability</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> detections;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.draw.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DrawTextField</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Math</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">round</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">age</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}岁\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gender</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} (\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Math</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">round</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">genderProbability</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}%)\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  detections.detection.box.bottomLeft</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">draw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(canvas);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="四、高级应用场景" tabindex="-1">四、高级应用场景 <a class="header-anchor" href="#四、高级应用场景" aria-label="Permalink to &quot;四、高级应用场景&quot;">​</a></h2><h4 id="_1-人脸比对-1-1-验证" tabindex="-1">1. 人脸比对（1:1 验证） <a class="header-anchor" href="#_1-人脸比对-1-1-验证" aria-label="Permalink to &quot;1. 人脸比对（1:1 验证）&quot;">​</a></h4><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> img1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;img1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> img2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;img2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> descriptor1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">detectSingleFace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(img1)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">withFaceDescriptor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> descriptor2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">detectSingleFace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(img2)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">withFaceDescriptor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> distance</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">euclideanDistance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(descriptor1.descriptor, descriptor2.descriptor);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(distance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.6</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;同一人&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;不同人&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_2-多人识别-1-n-检索" tabindex="-1">2. 多人识别（1:N 检索） <a class="header-anchor" href="#_2-多人识别-1-n-检索" aria-label="Permalink to &quot;2. 多人识别（1:N 检索）&quot;">​</a></h4><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 注册已知人脸库</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> labeledDescriptors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LabeledFaceDescriptors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张三&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [descriptor1, descriptor2]),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LabeledFaceDescriptors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;李四&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [descriptor3])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> faceMatcher</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FaceMatcher</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(labeledDescriptors, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 识别未知人脸</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> unknownDescriptor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">detectSingleFace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(img).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">withFaceDescriptor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> bestMatch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceMatcher.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findBestMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(unknownDescriptor.descriptor);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`识别结果: \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bestMatch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">label</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="五、性能优化与调试" tabindex="-1">五、性能优化与调试 <a class="header-anchor" href="#五、性能优化与调试" aria-label="Permalink to &quot;五、性能优化与调试&quot;">​</a></h2><h4 id="_1-模型选型建议" tabindex="-1">1. 模型选型建议 <a class="header-anchor" href="#_1-模型选型建议" aria-label="Permalink to &quot;1. 模型选型建议&quot;">​</a></h4><p>| 模型类型 | 大小 | 速度 | 精度 | 适用场景 | | ---------------- | --------- | ---- | ----------------- | | TinyFaceDetector | 200KB ⚡️⚡️⚡️ | ⭐️⭐️ | 实时摄像头/移动端 | | SsdMobilenetv1 | 5.4MB ⚡️⚡️ | ⭐️⭐️⭐️ | 静态图像分析 | | FaceLandmark68 | 1.2MB ⚡️ | ⭐️⭐️⭐️⭐️ | 高精度特征点定位 |</p><h4 id="_2-优化策略" tabindex="-1">2. 优化策略 <a class="header-anchor" href="#_2-优化策略" aria-label="Permalink to &quot;2. 优化策略&quot;">​</a></h4><ul><li>降低检测频率：setInterval 间隔从 100ms 调整为 300ms</li><li>缩小检测区域：对视频帧裁剪人脸区域后再分析</li><li>Web Worker：将计算移至后台线程避免阻塞 UI</li><li>缓存模型：首次加载后缓存模型减少重复请求</li></ul><h4 id="_3-调试工具" tabindex="-1">3. 调试工具 <a class="header-anchor" href="#_3-调试工具" aria-label="Permalink to &quot;3. 调试工具&quot;">​</a></h4><ul><li>Chrome DevTools： <ul><li>查看模型加载状态</li><li>检查 canvas 绘制结果</li><li>模拟离线环境测试</li></ul></li><li>Lighthouse：评估性能瓶颈</li></ul><h2 id="六、实际案例" tabindex="-1">六、实际案例 <a class="header-anchor" href="#六、实际案例" aria-label="Permalink to &quot;六、实际案例&quot;">​</a></h2><h4 id="_1-安全监控系统" tabindex="-1">1. 安全监控系统 <a class="header-anchor" href="#_1-安全监控系统" aria-label="Permalink to &quot;1. 安全监控系统&quot;">​</a></h4><ul><li>功能：实时标记陌生人并报警</li><li>实现： <ol><li>注册已知人员人脸描述符</li><li>摄像头流中检测并比对</li><li>未匹配时触发警报</li></ol></li></ul><h4 id="_2-互动娱乐滤镜" tabindex="-1">2. 互动娱乐滤镜 <a class="header-anchor" href="#_2-互动娱乐滤镜" aria-label="Permalink to &quot;2. 互动娱乐滤镜&quot;">​</a></h4><ul><li>功能：在眼睛位置叠加表情符号 👀</li><li>代码片段：</li></ul><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> landmarks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> detection.landmarks;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> leftEye</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> landmarks.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getLeftEye</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rightEye</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> landmarks.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getRightEye</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> eyePos</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> leftEye[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rightEye[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 计算双眼中心</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">drawImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(emojiImg, eyePos.x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, eyePos.y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="七、迁移与替代方案" tabindex="-1">七、迁移与替代方案 <a class="header-anchor" href="#七、迁移与替代方案" aria-label="Permalink to &quot;七、迁移与替代方案&quot;">​</a></h2><h4 id="_1-face-api-js-的局限性" tabindex="-1">1. face-api.js 的局限性 <a class="header-anchor" href="#_1-face-api-js-的局限性" aria-label="Permalink to &quot;1. face-api.js 的局限性&quot;">​</a></h4><ul><li>原作者自 2020 年停止维护，存在兼容性问题</li><li>Node.js 环境需额外安装 windows-build-tools 和 Python</li></ul><h4 id="_2-推荐替代方案" tabindex="-1">2. 推荐替代方案 <a class="header-anchor" href="#_2-推荐替代方案" aria-label="Permalink to &quot;2. 推荐替代方案&quot;">​</a></h4><ul><li>@vladmandic/face-api：社区维护分支，支持新版 TensorFlow.js</li><li>MediaPipe Face Detection：Google 开源方案，支持轻量级实时检测</li></ul><h4 id="_3-迁移示例" tabindex="-1">3. 迁移示例 <a class="header-anchor" href="#_3-迁移示例" aria-label="Permalink to &quot;3. 迁移示例&quot;">​</a></h4><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@vladmandic/face-api&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 接口与原版基本一致</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> faceapi.nets.tinyFaceDetector.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadFromUri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/models&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="八、常见问题解决" tabindex="-1">八、常见问题解决 <a class="header-anchor" href="#八、常见问题解决" aria-label="Permalink to &quot;八、常见问题解决&quot;">​</a></h2><table tabindex="0"><thead><tr><th>问题</th><th>解决方案</th></tr></thead><tbody><tr><td>模型加载失败</td><td>检查路径权限，确保模型文件可访问</td></tr><tr><td>摄像头无法启动</td><td>确认 HTTPS 环境（本地 localhost 除外）</td></tr><tr><td>人脸识别精度低</td><td>改用 SsdMobilenetv1 模型并增加图像分辨率</td></tr><tr><td>Node.js 报错</td><td>Module not found 安装 node-polyfill-webpack-plugin</td></tr></tbody></table><h2 id="🔗-九、参考资料" tabindex="-1">🔗 九、参考资料 <a class="header-anchor" href="#🔗-九、参考资料" aria-label="Permalink to &quot;🔗 九、参考资料&quot;">​</a></h2><p><a href="https://github.com/justadudewhohacks/face-api.js-models" target="_blank" rel="noreferrer">📚 官方模型下载</a></p><p><a href="https://github.com/vladmandic/face-api" target="_blank" rel="noreferrer">📚 @vladmandic/face-api</a></p><p><a href="https://github.com/justadudewhohacks/face-api.js-demo" target="_blank" rel="noreferrer">📚 完整代码示例</a></p><blockquote><p>提示：生产环境务必考虑伦理问题（如性别识别偏见），建议结合人工审核机制</p></blockquote>`,48))])}const C=h(d,[["render",c]]);export{m as __pageData,C as default};
